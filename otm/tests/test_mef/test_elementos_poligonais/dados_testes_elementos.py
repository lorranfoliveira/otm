import numpy as np

# Dados de entrada para testes de verificação da matriz de rigidez
# Coordenadas dos elementos
elementos = {4: np.array([[2.7556565614779, 9.20392234649015e-14],
                          [2.78107316648459, 6.89431151057462e-14],
                          [2.7813500442904, 0.0213997447155802],
                          [2.76023123817064, 0.0263447404713824]]),
             5: np.array([[7.30821653194269e-14, 0.40449608828149],
                          [0.0122135693945218, 0.405681559760994],
                          [0.0233831653015617, 0.424817589984127],
                          [0.0163422170761593, 0.434478501922681],
                          [6.02243949154868e-14, 0.434929646295161]]),
             6: np.array([[0.554115458640025, 0.0253781540841805],
                          [0.560383029024321, 0.0210329937202393],
                          [0.578750584566741, 0.0264571581152724],
                          [0.579888801483695, 0.0396780873465809],
                          [0.56584447624715, 0.0499325875068519],
                          [0.552907460593646, 0.0447857172495498]]),
             7: np.array([[0.999804702713547, 0.284216157875479],
                          [1.00968230627519, 0.280886987294624],
                          [1.02281346439718, 0.288446994180082],
                          [1.02216773282869, 0.308546230380742],
                          [1.01948780743905, 0.310693738326253],
                          [1.00341069039175, 0.309319692905111],
                          [0.995119874782824, 0.297087871908502]]),
             8: np.array([[1.83818947676447, 0.958463353000126],
                          [1.85447007339835, 0.944469152067395],
                          [1.86070165833429, 0.945422371043546],
                          [1.86959971404982, 0.955832968878229],
                          [1.86821434626327, 0.970719915354334],
                          [1.86073575351678, 0.975851387177614],
                          [1.84024197569343, 0.972331938944702],
                          [1.8383476687162, 0.970379364884249]])}

# Resultados esperados
# Matrizes de rigidezes
ke = {4: np.array([[0.4963432482103793, 0.1748565953762529, -0.28932629546537125, 0.022696961621483158,
                    -0.2923652167392779, -0.17430905762581944, 0.08534826399426984, -0.02324449937191659],
                   [0.1748565953762529, 0.4117004805310171, 0.0501694890940106, 0.06292911259330304,
                    -0.1743090576258195, -0.21281807692400395, -0.05071702684444404, -0.2618115162003162],
                   [-0.28932629546537125, 0.05016948909401063, 0.47147553745303267, -0.17451629218421372,
                    0.02879272032419549, -0.05086883875738592, -0.21094196231185686, 0.17521564184758903],
                   [0.022696961621483158, 0.06292911259330301, -0.17451629218421372, 0.5324320599314006,
                    -0.02339631128485845, -0.31695423123332456, 0.17521564184758903, -0.27840694129137905],
                   [-0.2923652167392779, -0.1743090576258195, 0.028792720324195466, -0.023396311284858445,
                    0.5936680274562914, 0.1751178440524256, -0.3300955310412089, 0.0225875248582523],
                   [-0.17430905762581944, -0.21281807692400395, -0.05086883875738592, -0.31695423123332456,
                    0.17511784405242561, 0.506593964340771, 0.05006005233077978, 0.023178343816557423],
                   [0.08534826399426984, -0.05071702684444404, -0.21094196231185686, 0.175215641847589,
                    -0.3300955310412089, 0.050060052330779765, 0.455689229358796, -0.17455866733392472],
                   [-0.02324449937191659, -0.2618115162003162, 0.17521564184758903, -0.27840694129137905,
                    0.022587524858252307, 0.023178343816557437, -0.17455866733392478, 0.5170401136751379]]),
      5: np.array([[0.7421077804206887, 0.08710624491082386, -0.5817413740604677, 0.09590206393858343,
                    -0.3141690054993013, -0.056917264489635334, -0.09882400628523991, -0.13395246608432096,
                    0.2526266054243196, 0.007861421724548498],
                   [0.08710624491082386, 0.4288693664761084, 0.12336001552154865, -0.1978179298060933,
                    -0.05689368020490729, -0.04935004581126443, -0.13397605036904905, -0.1256389770114887,
                    -0.019596529858416683, -0.05606241384726231],
                   [-0.5817413740604676, 0.12336001552154868, 0.7268258199523172, -0.20624552420608627,
                    0.09298671427092867, -0.10724587245555794, 0.006612450301356546, 0.03241098204819211,
                    -0.24468361046413428, 0.15772039909190405],
                   [0.09590206393858346, -0.1978179298060933, -0.20624552420608627, 0.6536735823612321,
                    -0.07978792087259272, -0.014476222253823749, 0.03243456633292014, -0.22881562242685066,
                    0.15769681480717598, -0.2125638078744644],
                   [-0.31416900549930127, -0.05689368020490728, 0.09298671427092867, -0.0797879208725927,
                    0.7636938247145438, -0.07272043708093634, -0.1936593223303516, 0.11512390538563022,
                    -0.3488522111558201, 0.09427813277280636],
                   [-0.05691726448963532, -0.04935004581126442, -0.10724587245555794, -0.014476222253823735,
                    -0.07272043708093631, 0.42621342353745534, 0.14258185696859546, -0.26002916191030206,
                    0.09430171705753437, -0.10235799356206461],
                   [-0.09882400628523991, -0.13397605036904905, 0.006612450301356546, 0.03243456633292014,
                    -0.19365932233035166, 0.14258185696859546, 0.6119227373466529, 0.04688691395287954,
                    -0.3260518590324184, -0.08792728688534668],
                   [-0.13395246608432096, -0.12563897701148874, 0.03241098204819211, -0.2288156224268507,
                    0.11512390538563022, -0.260029161910302, 0.046886913952879555, 0.6619884601643464,
                    -0.06046933530238148, -0.04750469881570608],
                   [0.2526266054243196, -0.019596529858416686, -0.24468361046413428, 0.15769681480717598,
                    -0.3488522111558201, 0.09430171705753437, -0.3260518590324184, -0.06046933530238148,
                    0.6669610752280544, -0.17193266670391197],
                   [0.007861421724548503, -0.05606241384726231, 0.15772039909190405, -0.2125638078744644,
                    0.09427813277280636, -0.10235799356206461, -0.08792728688534669, -0.04750469881570607,
                    -0.17193266670391197, 0.4184889140994984]]),
      6: np.array([[0.7270850210753047, 0.03632253749029048, -0.3417450322018134, 0.09242769517780525,
                    -0.24237036815167762, 0.04534179344210265, -0.1351682627541017, -0.07252520775392524,
                    -0.1130952689382077, -0.10765575177347148, 0.10529391097049566, 0.006088933417198229],
                   [0.03632253749029048, 0.5411181764539889, 0.1197591821559127, -0.2663693184854689,
                    0.04548283393652265, -0.0498176857564491, -0.07252520775392526, 0.005571178407729995,
                    -0.1077967922678914, -0.1617713545881959, -0.021242553560909254, -0.06873099603160526],
                   [-0.34174503220181335, 0.1197591821559127, 0.5364347688399633, -0.03293501100209435,
                    -0.0412878993660581, -0.07043921061907595, -0.08777374768088511, -0.09750083366684449,
                    0.031950356103771664, -0.014472351867243854, -0.09757844569497842, 0.095588224999346],
                   [0.09242769517780525, -0.26636931848546885, -0.03293501100209435, 0.7265871516566986,
                    -0.043107723640968466, 0.0822780602228985, -0.09735979317242453, -0.1801054534370928,
                    -0.014472351867243858, -0.16814705001451122, 0.09544718450492601, -0.19424338994252408],
                   [-0.24237036815167762, 0.04548283393652265, -0.04128789936605814, -0.043107723640968466,
                    0.5183039598462859, -0.12735571948235713, -0.06811810572208406, -0.04269987952926124,
                    -0.05364576865258732, 0.07476600595131207, -0.1128818179538788, 0.0929144827647523],
                   [0.04534179344210265, -0.0498176857564491, -0.07043921061907595, 0.0822780602228985,
                    -0.12735571948235713, 0.5524147534872468, -0.015368392551153772, -0.3085802941104165,
                    0.07490704644573203, -0.225220360747247, 0.09291448276475227, -0.05107447309603236],
                   [-0.1351682627541017, -0.07252520775392526, -0.08777374768088511, -0.09735979317242453,
                    -0.06811810572208407, -0.015368392551153777, 0.6084072888949583, 0.10097731989331951,
                    -0.07238519372449803, 0.07456714442750349, -0.2449619790133897, 0.00970892915668045],
                   [-0.07252520775392524, 0.005571178407729985, -0.09750083366684446, -0.1801054534370928,
                    -0.04269987952926125, -0.3085802941104165, 0.10097731989331951, 0.5208679479583559,
                    0.10189863140561092, -0.01736078727995648, 0.009849969651100424, -0.020392591538620216],
                   [-0.1130952689382077, -0.1077967922678914, 0.03195035610377167, -0.014472351867243861,
                    -0.053645768652587314, 0.07490704644573203, -0.07238519372449802, 0.10189863140561094,
                    0.46580560211770816, 0.05717057285658795, -0.25862972690618624, -0.11170710657279552],
                   [-0.10765575177347148, -0.16177135458819591, -0.014472351867243854, -0.16814705001451122,
                    0.07476600595131207, -0.225220360747247, 0.0745671444275035, -0.017360787279956474,
                    0.05717057285658795, 0.673830663485144, -0.08437561959468802, -0.10133111085523298],
                   [0.10529391097049566, -0.021242553560909254, -0.09757844569497841, 0.09544718450492601,
                    -0.1128818179538788, 0.09291448276475228, -0.24496197901338973, 0.00984996965110042,
                    -0.25862972690618624, -0.08437561959468803, 0.6087580585979374, -0.09259346376518156],
                   [0.006088933417198239, -0.06873099603160526, 0.095588224999346, -0.19424338994252405,
                    0.0929144827647523, -0.05107447309603236, 0.009708929156680444, -0.020392591538620223,
                    -0.11170710657279552, -0.10133111085523301, -0.09259346376518156, 0.43577256146401505]]),
      7: np.array([[0.5580090661936227, 0.04249476555230447, -0.19533166972106963, 0.0347067118610776,
                    -0.25294990778210913, -0.009134735328692929, -0.07066515723628039, -0.06409785477719887,
                    0.021643374544537963, -0.06005134590429359, -0.03799563768466023, -0.008050845645492473,
                    -0.022710068314041144, 0.06413330424229567],
                   [0.04249476555230447, 0.5161754857231197, 0.06159953117181033, -0.08480753169115951,
                    -0.00858711860703228, -0.05389365161460391, -0.06428374036893307, 0.007627727064261474,
                    -0.059865460312559376, -0.051172312248260104, -0.00859846236715309, -0.21434086467396885,
                    0.0372404849315629, -0.11958885255938895],
                   [-0.1953316697210697, 0.06159953117181034, 0.5098658856811757, -0.0557935865478421,
                    -0.14503563965524854, -0.08665547339153754, -0.05396200448422844, -0.07054863704599365,
                    0.058755323352818065, -0.0022849076872656785, -0.008377175248867285, 0.057101669671217534,
                    -0.16591471992457932, 0.09658140382961108],
                   [0.03470671186107761, -0.08480753169115951, -0.05579358654784209, 0.6089948406938642,
                    -0.05976265408080483, -0.04163255712713047, -0.07000102032433296, -0.11113400590873089,
                    -0.0024707932789998716, -0.09851195639595327, 0.05728755526295173, -0.12943515924970234,
                    0.09603378710795045, -0.14347363032118754],
                   [-0.2529499077821091, -0.00858711860703228, -0.14503563965524854, -0.05976265408080482,
                    0.6964352635559633, -0.1489128301529777, 0.14994743733122567, -0.015687359655649196,
                    -0.15860014288395533, 0.09576505812342113, -0.12778911128369405, 0.08565148929399873,
                    -0.16200789928218262, 0.05153341507904427],
                   [-0.009134735328692932, -0.05389365161460391, -0.08665547339153754, -0.04163255712713047,
                    -0.1489128301529777, 0.45159165036858523, 0.011205459655083435, -0.007519832471938489,
                    0.0963126748450818, -0.21462137455280494, 0.08546560370226455, -0.1111759641030533,
                    0.05171930067077846, -0.022748270499054486],
                   [-0.07066515723628036, -0.06428374036893307, -0.05396200448422844, -0.07000102032433296,
                    0.14994743733122567, 0.011205459655083435, 0.7921489396286988, -0.05107158892287625,
                    -0.4084248793037097, 0.09350204601101071, -0.2750113297107859, 0.09132378844829962,
                    -0.13403300622492084, -0.010674944498251633],
                   [-0.06409785477719887, 0.007627727064261477, -0.07054863704599364, -0.11113400590873089,
                    -0.015687359655649196, -0.007519832471938489, -0.05107158892287625, 0.5813659345016513,
                    0.12039486532174347, -0.34251823930569053, 0.09187140516996031, -0.15766330149599572,
                    -0.010860830089985833, 0.02984171761644249],
                   [0.021643374544537956, -0.05986546031255938, 0.058755323352818065, -0.0024707932789998725,
                    -0.15860014288395533, 0.0963126748450818, -0.4084248793037097, 0.12039486532174347,
                    0.6237191887328859, -0.07684235559997404, -0.026326115885445305, -0.013318783995552053,
                    -0.11076674855713077, -0.06421014697973979],
                   [-0.06005134590429359, -0.051172312248260104, -0.0022849076872656785, -0.09851195639595325,
                    0.09576505812342115, -0.21462137455280494, 0.09350204601101071, -0.3425182393056906,
                    -0.07684235559997406, 0.671008485613887, 0.013574035315180703, 0.08511031333857064,
                    -0.06366253025807914, -0.049294916449748316],
                   [-0.037995637684660244, -0.00859846236715309, -0.008377175248867287, 0.05728755526295173,
                    -0.12778911128369405, 0.08546560370226454, -0.2750113297107859, 0.0918714051699603,
                    -0.026326115885445294, 0.01357403531518071, 0.5261903768747204, -0.15928635990129164,
                    -0.050691007061267564, -0.0803137771819125],
                   [-0.008050845645492478, -0.21434086467396882, 0.057101669671217534, -0.1294351592497023,
                    0.08565148929399873, -0.11117596410305332, 0.09132378844829962, -0.15766330149599578,
                    -0.01331878399555206, 0.08511031333857064, -0.15928635990129164, 0.6650329895812489,
                    -0.05342095787117971, -0.13752801339709853],
                   [-0.022710068314041158, 0.03724048493156292, -0.16591471992457932, 0.09603378710795045,
                    -0.1620078992821826, 0.05171930067077846, -0.13403300622492084, -0.010860830089985835,
                    -0.11076674855713077, -0.06366253025807915, -0.050691007061267564, -0.05342095787117971,
                    0.6461234493641217, -0.057049254491047294],
                   [0.06413330424229569, -0.11958885255938895, 0.09658140382961108, -0.14347363032118754,
                    0.05153341507904427, -0.02274827049905449, -0.010674944498251633, 0.02984171761644249,
                    -0.06421014697973979, -0.04929491644974833, -0.0803137771819125, -0.13752801339709853,
                    -0.057049254491047294, 0.4427919656100348]]),
      8: np.array([[0.7081229251174828, 0.20271574413661853, 0.0635494560503425, 0.05666332812389798,
                    -0.22789407658047375, 0.0028939931348391443, -0.1520989230727226, -0.02151454896301396,
                    -0.08994570623774992, -0.05562689941899524, -0.09104448492864115, -0.06903309937062876,
                    -0.19717231630927579, -0.08723566712871496, -0.01351687403896213, -0.028862850514003127],
                   [0.2027157441366185, 0.5766343224454369, 0.08271386068725509, 0.10069383421813033,
                    0.004158640783211458, -0.07106578346503864, -0.021881035909795, -0.01786106233176856,
                    -0.055626899418995235, -0.020069283786839434, -0.06866661242384772, -0.13704198237216844,
                    -0.08850031477708722, -0.33235653233820067, -0.05491338307736021, -0.09893351236955106],
                   [0.06354945605034251, 0.08271386068725509, 0.5596672144363164, 0.1324824974219628,
                    -0.2912457431703062, -0.05977671931717046, -0.2574416187018694, -0.069562528951925,
                    -0.04623826121828978, -0.07014737411794952, -0.01046228134986352, -0.0367145097543839,
                    0.003996570552814183, -0.0029959183639358816, -0.02182533659914388, 0.024000692396146456],
                   [0.05666332812389798, 0.1006938342181303, 0.1324824974219628, 0.6275282072753479,
                    -0.03372618675381332, -0.16646147562584437, -0.06829788130355266, -0.13217679223281348,
                    -0.07051386106473055, -0.06179794866242214, -0.036714509754383895, -0.11841088756602361,
                    -0.002629431417154839, -0.13486609741683625, 0.022736044747774145, -0.11450883998953829],
                   [-0.2278940765804738, 0.004158640783211451, -0.2912457431703062, -0.033726186753813316,
                    0.5495005041710315, -0.0014814055420454358, -0.024293147642607447, -0.05660629692833799,
                    -0.04009243011189133, -0.03668105875858282, 0.022396219257098057, 0.017293513917970012,
                    0.011506949498397104, 0.046269016598737424, 0.0001217245787525599, 0.060773776682861026],
                   [0.002893993134839146, -0.07106578346503864, -0.059776719317170435, -0.16646147562584437,
                    -0.0014814055420454423, 0.5180123289922287, -0.03055576436498087, -0.004650276356800842,
                    -0.03541641111021051, -0.13294263957738892, 0.016927026971188964, -0.11207425477435748,
                    0.04626901659873742, -0.06092647895568885, 0.061140263629642075, 0.0301085797628904],
                   [-0.1520989230727226, -0.021881035909795, -0.2574416187018694, -0.06829788130355266,
                    -0.024293147642607447, -0.030555764364980864, 0.6644441911566509, -0.05678838993137066,
                    0.02981196854842824, 0.010257327295826225, -0.1337898342985502, 0.07645505136499786,
                    -0.06248937396230883, 0.06190047283811698, -0.06414326202702154, 0.028910220010758342],
                   [-0.02151454896301396, -0.017861062331768554, -0.06956252895192501, -0.13217679223281348,
                    -0.05660629692833798, -0.0046502763568008355, -0.05678838993137067, 0.447174547915408,
                    0.03630785985918332, -0.06425851260912888, 0.07771969901337016, -0.21793645742486215,
                    0.06153398589133595, -0.047131420677181804, 0.028910220010758336, 0.03683997371714816],
                   [-0.08994570623774992, -0.05562689941899524, -0.04623826121828977, -0.07051386106473055,
                    -0.04009243011189133, -0.03541641111021051, 0.02981196854842824, 0.036307859859183306,
                    0.5325229592722323, 0.03741308975191348, -0.17940184612064988, 0.059631042963633904,
                    -0.1435497142668679, 0.046857592257095154, -0.06310696986521147, -0.018652413237890072],
                   [-0.05562689941899525, -0.020069283786839434, -0.07014737411794952, -0.06179794866242213,
                    -0.03668105875858282, -0.13294263957738892, 0.010257327295826225, -0.06425851260912888,
                    0.037413089751913486, 0.4837484803832868, 0.08568157552699103, -0.20196833201030523,
                    0.048122239905467476, -0.06911756646259987, -0.019018900184671117, 0.06640580272539799],
                   [-0.09104448492864115, -0.06866661242384771, -0.01046228134986352, -0.036714509754383895,
                    0.022396219257098064, 0.016927026971188964, -0.1337898342985502, 0.07771969901337016,
                    -0.17940184612064988, 0.08568157552699103, 0.45354271498173465, 0.026300128152041396,
                    0.07983703170846877, -0.02865589581638597, -0.14107751924959624, -0.07259141166897394],
                   [-0.06903309937062876, -0.1370419823721684, -0.036714509754383895, -0.11841088756602362,
                    0.017293513917970012, -0.11207425477435748, 0.07645505136499786, -0.21793645742486215,
                    0.059631042963633904, -0.20196833201030523, 0.026300128152041396, 0.7706649781919741,
                    -0.002605363253028848, 0.19603040757592916, -0.07132676402060163, -0.17926347162018724],
                   [-0.1971723163092758, -0.08850031477708722, 0.003996570552814183, -0.002629431417154834,
                    0.011506949498397102, 0.04626901659873742, -0.062489373962308845, 0.06153398589133593,
                    -0.1435497142668679, 0.048122239905467476, 0.07983703170846877, -0.002605363253028862,
                    0.5396861109030389, 0.0008676188098800369, -0.2318152581242661, -0.06305775175814914],
                   [-0.08723566712871497, -0.33235653233820067, -0.0029959183639358834, -0.13486609741683625,
                    0.04626901659873742, -0.06092647895568885, 0.06190047283811698, -0.04713142067718179,
                    0.046857592257095154, -0.06911756646259987, -0.02865589581638597, 0.19603040757592916,
                    0.0008676188098800403, 0.8209160849747829, -0.03700721919479207, -0.3725483967002052],
                   [-0.01351687403896213, -0.05491338307736021, -0.021825336599143888, 0.02273604474777415,
                    0.00012172457875255904, 0.061140263629642075, -0.06414326202702154, 0.028910220010758336,
                    -0.06310696986521148, -0.019018900184671117, -0.14107751924959624, -0.07132676402060163,
                    -0.2318152581242661, -0.037007219194792065, 0.5353634953254477, 0.06947973808925041],
                   [-0.028862850514003134, -0.09893351236955107, 0.024000692396146453, -0.11450883998953826,
                    0.06077377668286102, 0.0301085797628904, 0.028910220010758342, 0.03683997371714816,
                    -0.01865241323789007, 0.06640580272539799, -0.07259141166897394, -0.17926347162018724,
                    -0.06305775175814915, -0.3725483967002053, 0.06947973808925041, 0.6318998644740456]])}
